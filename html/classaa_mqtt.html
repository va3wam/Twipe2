<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Twipe2: aaMqtt Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="twipe2-logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Twipe2
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
   <div id="projectbrief">Second generation two-wheeled inverted pendulumn robot</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classaa_mqtt-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">aaMqtt Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8fe0df533de2e25f1dfb2f0c8e626f7d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classaa_mqtt.html#a8fe0df533de2e25f1dfb2f0c8e626f7d">aaMqtt</a> ()</td></tr>
<tr class="memdesc:a8fe0df533de2e25f1dfb2f0c8e626f7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the default constructor for this class.  <a href="classaa_mqtt.html#a8fe0df533de2e25f1dfb2f0c8e626f7d">More...</a><br /></td></tr>
<tr class="separator:a8fe0df533de2e25f1dfb2f0c8e626f7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87e8a4db1a43fbd5d71b77a56a15b7e0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classaa_mqtt.html#a87e8a4db1a43fbd5d71b77a56a15b7e0">~aaMqtt</a> ()</td></tr>
<tr class="separator:a87e8a4db1a43fbd5d71b77a56a15b7e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a7ce99a71ff5d6575dda7b1e60224850c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classaa_mqtt.html#a7ce99a71ff5d6575dda7b1e60224850c">connect</a> (IPAddress address, const char *uniqueName)</td></tr>
<tr class="separator:a7ce99a71ff5d6575dda7b1e60224850c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adac5c0bf0c8b6ab2ba6ee6b6c5c2ad7c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classaa_mqtt.html#adac5c0bf0c8b6ab2ba6ee6b6c5c2ad7c">onMqttConnect</a> (bool sessionPresent)</td></tr>
<tr class="memdesc:adac5c0bf0c8b6ab2ba6ee6b6c5c2ad7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle CONNACK from the MQTT broker.  <a href="classaa_mqtt.html#adac5c0bf0c8b6ab2ba6ee6b6c5c2ad7c">More...</a><br /></td></tr>
<tr class="separator:adac5c0bf0c8b6ab2ba6ee6b6c5c2ad7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6abfaec4d1b1fbeecb547433e98fa9fc"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classaa_mqtt.html#a6abfaec4d1b1fbeecb547433e98fa9fc">onMqttDisconnect</a> (AsyncMqttClientDisconnectReason reason)</td></tr>
<tr class="memdesc:a6abfaec4d1b1fbeecb547433e98fa9fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle disconnecting from an MQTT broker.  <a href="classaa_mqtt.html#a6abfaec4d1b1fbeecb547433e98fa9fc">More...</a><br /></td></tr>
<tr class="separator:a6abfaec4d1b1fbeecb547433e98fa9fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90c3bfc78093d9d05ffad2a86f06ea68"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classaa_mqtt.html#a90c3bfc78093d9d05ffad2a86f06ea68">onMqttSubscribe</a> (uint16_t packetId, uint8_t qos)</td></tr>
<tr class="memdesc:a90c3bfc78093d9d05ffad2a86f06ea68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle SUBACK from MQTT broker.  <a href="classaa_mqtt.html#a90c3bfc78093d9d05ffad2a86f06ea68">More...</a><br /></td></tr>
<tr class="separator:a90c3bfc78093d9d05ffad2a86f06ea68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1be714946ce7d4ca63f4336778ada139"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classaa_mqtt.html#a1be714946ce7d4ca63f4336778ada139">onMqttUnsubscribe</a> (uint16_t packetId)</td></tr>
<tr class="memdesc:a1be714946ce7d4ca63f4336778ada139"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle UNSUBACK message from MQTT broker.  <a href="classaa_mqtt.html#a1be714946ce7d4ca63f4336778ada139">More...</a><br /></td></tr>
<tr class="separator:a1be714946ce7d4ca63f4336778ada139"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4aec787c2d889e0b07573f100be7c22"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classaa_mqtt.html#ac4aec787c2d889e0b07573f100be7c22">publishMQTT</a> (String topic, String msg)</td></tr>
<tr class="memdesc:ac4aec787c2d889e0b07573f100be7c22"><td class="mdescLeft">&#160;</td><td class="mdescRight">Publish a message to the specified MQTT broker topic tree.  <a href="classaa_mqtt.html#ac4aec787c2d889e0b07573f100be7c22">More...</a><br /></td></tr>
<tr class="separator:ac4aec787c2d889e0b07573f100be7c22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab99783465de2e21a13eeadbb5e39b7b8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classaa_mqtt.html#ab99783465de2e21a13eeadbb5e39b7b8">publishEvent</a> (int evtId, int evtSev, String evtMsg)</td></tr>
<tr class="memdesc:ab99783465de2e21a13eeadbb5e39b7b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Publishes messages to the health event topic on the MQTT broker.  <a href="classaa_mqtt.html#ab99783465de2e21a13eeadbb5e39b7b8">More...</a><br /></td></tr>
<tr class="separator:ab99783465de2e21a13eeadbb5e39b7b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada4234e578ec002c58e86db16b9162d8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classaa_mqtt.html#ada4234e578ec002c58e86db16b9162d8">onMqttMessage</a> (char *topic, char *payload, AsyncMqttClientMessageProperties properties, size_t len, size_t index, size_t total)</td></tr>
<tr class="memdesc:ada4234e578ec002c58e86db16b9162d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle incoming messages from MQTT broker.  <a href="classaa_mqtt.html#ada4234e578ec002c58e86db16b9162d8">More...</a><br /></td></tr>
<tr class="separator:ada4234e578ec002c58e86db16b9162d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a235eb322300f2c9616754ba202962ad0"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classaa_mqtt.html#a235eb322300f2c9616754ba202962ad0">onMqttPublish</a> (uint16_t packetId)</td></tr>
<tr class="memdesc:a235eb322300f2c9616754ba202962ad0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle the reciept of a PUBACK message message from MQTT broker.  <a href="classaa_mqtt.html#a235eb322300f2c9616754ba202962ad0">More...</a><br /></td></tr>
<tr class="separator:a235eb322300f2c9616754ba202962ad0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="aa_mqtt_8h_source.html#l00022">22</a> of file <a class="el" href="aa_mqtt_8h_source.html">aaMqtt.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a8fe0df533de2e25f1dfb2f0c8e626f7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fe0df533de2e25f1dfb2f0c8e626f7d">&#9670;&nbsp;</a></span>aaMqtt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">aaMqtt::aaMqtt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is the default constructor for this class. </p>
<h1><a class="anchor" id="autotoc_md21"></a>
@param const char* Argument description.</h1>

<p class="definition">Definition at line <a class="el" href="aa_mqtt_8cpp_source.html#l00043">43</a> of file <a class="el" href="aa_mqtt_8cpp_source.html">aaMqtt.cpp</a>.</p>

</div>
</div>
<a id="a87e8a4db1a43fbd5d71b77a56a15b7e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87e8a4db1a43fbd5d71b77a56a15b7e0">&#9670;&nbsp;</a></span>~aaMqtt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">aaMqtt::~aaMqtt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h1><a class="anchor" id="autotoc_md22"></a>
@brief This is the destructor for this class.</h1>

<p class="definition">Definition at line <a class="el" href="aa_mqtt_8cpp_source.html#l00051">51</a> of file <a class="el" href="aa_mqtt_8cpp_source.html">aaMqtt.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a7ce99a71ff5d6575dda7b1e60224850c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ce99a71ff5d6575dda7b1e60224850c">&#9670;&nbsp;</a></span>connect()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void aaMqtt::connect </td>
          <td>(</td>
          <td class="paramtype">IPAddress&#160;</td>
          <td class="paramname"><em>address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>uniqueName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<h1><a class="anchor" id="autotoc_md23"></a>
@brief Connect to MQTT broker.</h1>

<p class="definition">Definition at line <a class="el" href="aa_mqtt_8cpp_source.html#l00059">59</a> of file <a class="el" href="aa_mqtt_8cpp_source.html">aaMqtt.cpp</a>.</p>

</div>
</div>
<a id="adac5c0bf0c8b6ab2ba6ee6b6c5c2ad7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adac5c0bf0c8b6ab2ba6ee6b6c5c2ad7c">&#9670;&nbsp;</a></span>onMqttConnect()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void aaMqtt::onMqttConnect </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>sessionPresent</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handle CONNACK from the MQTT broker. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sessionPresent</td><td>persistent session available flag contained in CONNACK message from broker. </td></tr>
  </table>
  </dd>
</dl>
<h1><a class="anchor" id="autotoc_md24"></a>
CONNACK Message</h1>
<p>The CONNACK message contains two data entries:</p><ol type="1">
<li>The session present flag</li>
<li>A connect acknowledge flag</li>
</ol>
<h2><a class="anchor" id="autotoc_md25"></a>
Session Present Flag</h2>
<p>The session present flag tells the client whether the broker already has a persistent session available from previous interactions with the client. When a client connects with Clean Session set to true, the session present flag is always false because there is no session available. If a client connects with Clean Session set to false, there are two possibilities: If session information is available for the client Id. and the broker has stored session information, the session present flag is true. Otherwise, if the broker does not have any session information for the client ID, the session present flag is false. This flag was added in MQTT 3.1.1 to help clients determine whether they need to subscribe to topics or if the topics are still stored in a persistent session.</p>
<h2><a class="anchor" id="autotoc_md26"></a>
Connect Acknowledge Flag</h2>
<p>The second flag in the CONNACK message is the connect acknowledge flag. This flag contains a return code that tells the client whether the connection attempt was successful. Here are the return codes at a glance:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Return Code   </th><th class="markdownTableHeadLeft">Return Code Response    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">0   </td><td class="markdownTableBodyLeft">Connection accepted    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">1   </td><td class="markdownTableBodyLeft">Connection refused, unacceptable protocol version    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">2   </td><td class="markdownTableBodyLeft">Connection refused, identifier rejected    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">3   </td><td class="markdownTableBodyLeft">Connection refused, server unavailable    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">4   </td><td class="markdownTableBodyLeft">Connection refused, bad user name or password    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">5   </td><td class="markdownTableBodyLeft">Connection refused, not authorized   </td></tr>
</table>
<p>=================================================================================================== </p>

<p class="definition">Definition at line <a class="el" href="aa_mqtt_8cpp_source.html#l00110">110</a> of file <a class="el" href="aa_mqtt_8cpp_source.html">aaMqtt.cpp</a>.</p>

</div>
</div>
<a id="a6abfaec4d1b1fbeecb547433e98fa9fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6abfaec4d1b1fbeecb547433e98fa9fc">&#9670;&nbsp;</a></span>onMqttDisconnect()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void aaMqtt::onMqttDisconnect </td>
          <td>(</td>
          <td class="paramtype">AsyncMqttClientDisconnectReason&#160;</td>
          <td class="paramname"><em>reason</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handle disconnecting from an MQTT broker. </p>
<h1><a class="anchor" id="autotoc_md27"></a>
@param reason Reason for disconnect</h1>

<p class="definition">Definition at line <a class="el" href="aa_mqtt_8cpp_source.html#l00131">131</a> of file <a class="el" href="aa_mqtt_8cpp_source.html">aaMqtt.cpp</a>.</p>

</div>
</div>
<a id="ada4234e578ec002c58e86db16b9162d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada4234e578ec002c58e86db16b9162d8">&#9670;&nbsp;</a></span>onMqttMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void aaMqtt::onMqttMessage </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>topic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">AsyncMqttClientMessageProperties&#160;</td>
          <td class="paramname"><em>properties</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>total</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handle incoming messages from MQTT broker. </p>
<p>All messaging comes here and get seperated by select statement. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">topic</td><td>Which topic this message if about </td></tr>
    <tr><td class="paramname">payload</td><td>The content of the message sent from the MQTT broker </td></tr>
    <tr><td class="paramname">properties</td><td>A structure of flags with details from the message's packet header </td></tr>
    <tr><td class="paramname">len</td><td>Payload length. If unset or set to 0, the payload will be considered as a string and use strlen(payload) to calculte </td></tr>
    <tr><td class="paramname">index</td><td>The message ID. If unset or set to 0, the message ID will be automtaically assigned </td></tr>
    <tr><td class="paramname">total</td><td>Seems to be the same as len</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Property Flags The MQTT message has a header containing the following flags. </dd></dl>
<h2><a class="anchor" id="autotoc_md37"></a>
QOS Flag</h2>
<p>Two bits that show the QOS level of the message. Valid values are 1, 2 and 3 </p>
<h2><a class="anchor" id="autotoc_md38"></a>
Retain Flag</h2>
<p>Boolean value showing whether the message is saved by the broker as the last known good value for a specified topic. When a new client subscribes to a topic, they receive the last message that is retained on that topic. </p>
<h2><a class="anchor" id="autotoc_md39"></a>
DUP flag</h2>
<p>Boolean value indicates that the message is a duplicate and was resent because the intended recipient (client or broker) did not </p>
<h1><a class="anchor" id="autotoc_md40"></a>
acknowledge the original message. This is only relevant for QoS greater than 0.</h1>

<p class="definition">Definition at line <a class="el" href="aa_mqtt_8cpp_source.html#l00245">245</a> of file <a class="el" href="aa_mqtt_8cpp_source.html">aaMqtt.cpp</a>.</p>

</div>
</div>
<a id="a235eb322300f2c9616754ba202962ad0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a235eb322300f2c9616754ba202962ad0">&#9670;&nbsp;</a></span>onMqttPublish()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void aaMqtt::onMqttPublish </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>packetId</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handle the reciept of a PUBACK message message from MQTT broker. </p>
<h1><a class="anchor" id="autotoc_md41"></a>
@param packetId Unique identifier of the message.</h1>

<p class="definition">Definition at line <a class="el" href="aa_mqtt_8cpp_source.html#l00273">273</a> of file <a class="el" href="aa_mqtt_8cpp_source.html">aaMqtt.cpp</a>.</p>

</div>
</div>
<a id="a90c3bfc78093d9d05ffad2a86f06ea68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90c3bfc78093d9d05ffad2a86f06ea68">&#9670;&nbsp;</a></span>onMqttSubscribe()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void aaMqtt::onMqttSubscribe </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>packetId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>qos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handle SUBACK from MQTT broker. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packetId</td><td>Unique identifier of the message </td></tr>
    <tr><td class="paramname">qos</td><td>SUBACK return code </td></tr>
  </table>
  </dd>
</dl>
<h1><a class="anchor" id="autotoc_md28"></a>
Suback Message</h1>
<p>To confirm each subscription, the broker sends a SUBACK acknowledgement message to the client. This message contains the packet identifier of the original Subscribe message (to clearly identify the message) and a list of return codes. </p>
<h2><a class="anchor" id="autotoc_md29"></a>
Packet Identifier</h2>
<p>The packet identifier is a unique identifier used to identify a message. It is the same as in the SUBSCRIBE message.</p>
<h2><a class="anchor" id="autotoc_md30"></a>
Return Code</h2>
<p>The broker sends one return code for each topic/QoS-pair that it receives in the SUBSCRIBE message. For example, if the SUBSCRIBE message has five subscriptions, the SUBACK message contains five return codes. The return code acknowledges each topic and shows the QoS level that is granted by the broker. If the broker refuses a subscription, the SUBACK message conains a failure return code for that specific topic. For example, if the client has insufficient permission to subscribe to the topic or the topic is malformed.</p>
<h1><a class="anchor" id="autotoc_md31"></a>
Table of SUBACK return codes</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Return Code   </th><th class="markdownTableHeadLeft">Return Code Response    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">0   </td><td class="markdownTableBodyLeft">Success - Maximum QoS 0    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">1   </td><td class="markdownTableBodyLeft">Success - Maximum QoS 1    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">2   </td><td class="markdownTableBodyLeft">Success - Maximum QoS 2    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">128   </td><td class="markdownTableBodyLeft">Failure   </td></tr>
</table>
<p>=================================================================================================== </p>

<p class="definition">Definition at line <a class="el" href="aa_mqtt_8cpp_source.html#l00164">164</a> of file <a class="el" href="aa_mqtt_8cpp_source.html">aaMqtt.cpp</a>.</p>

</div>
</div>
<a id="a1be714946ce7d4ca63f4336778ada139"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1be714946ce7d4ca63f4336778ada139">&#9670;&nbsp;</a></span>onMqttUnsubscribe()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void aaMqtt::onMqttUnsubscribe </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>packetId</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handle UNSUBACK message from MQTT broker. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packetId</td><td>Unique identifier of the message. This is the same packet identifier that is in the UNSUBSCRIBE message. </td></tr>
  </table>
  </dd>
</dl>
<h1><a class="anchor" id="autotoc_md32"></a>
UNSUBACK Message</h1>
<p>To confirm the unsubscribe, the broker sends an UNSUBACK acknowledgement message to the client. This message contains only the packet identifier of the original UNSUBSCRIBE message (to clearly identify the message). After receiving the UNSUBACK from the </p>
<h1><a class="anchor" id="autotoc_md33"></a>
broker, the client can assume that the subscriptions in the UNSUBSCRIBE message are deleted.</h1>

<p class="definition">Definition at line <a class="el" href="aa_mqtt_8cpp_source.html#l00179">179</a> of file <a class="el" href="aa_mqtt_8cpp_source.html">aaMqtt.cpp</a>.</p>

</div>
</div>
<a id="ab99783465de2e21a13eeadbb5e39b7b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab99783465de2e21a13eeadbb5e39b7b8">&#9670;&nbsp;</a></span>publishEvent()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void aaMqtt::publishEvent </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>evtId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>evtSev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>evtMsg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Publishes messages to the health event topic on the MQTT broker. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">int</td><td>Event ID. </td></tr>
    <tr><td class="paramname">int</td><td>Event severity? </td></tr>
  </table>
  </dd>
</dl>
<h1><a class="anchor" id="autotoc_md36"></a>
@param String Event message.</h1>

<p class="definition">Definition at line <a class="el" href="aa_mqtt_8cpp_source.html#l00218">218</a> of file <a class="el" href="aa_mqtt_8cpp_source.html">aaMqtt.cpp</a>.</p>

</div>
</div>
<a id="ac4aec787c2d889e0b07573f100be7c22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4aec787c2d889e0b07573f100be7c22">&#9670;&nbsp;</a></span>publishMQTT()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void aaMqtt::publishMQTT </td>
          <td>(</td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>topic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Publish a message to the specified MQTT broker topic tree. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">topic</td><td>The topic tree to publish the messge to </td></tr>
    <tr><td class="paramname">msg</td><td>The message to send </td></tr>
  </table>
  </dd>
</dl>
<h1><a class="anchor" id="autotoc_md34"></a>
MQTT Published Messages</h1>
<p>TWIPe issues a number of messages to the MQTT broker. Each message goes to it's own topic tree. These messages and their respective topic trees are outlined in the table below. Note hat the robot name is made up of the prefix twipe followed by the MAC address of the ESP32. This acts as a unique identifier of the robot and is used to ensure that each robot has its own unique data tree structure on the MQTT broker. THis design allows for multipple twipe robots to share the same MQTT broker. </p>
<h2><a class="anchor" id="autotoc_md35"></a>
Table of Published Messages</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Topic   </th><th class="markdownTableHeadLeft">Topic Tree   </th><th class="markdownTableHeadLeft">Details    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Balance telemetry   </td><td class="markdownTableBodyLeft">{robot name}/telemetry/balance   </td><td class="markdownTableBodyLeft">Angle of IMU orientation in degrees    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Robot Metadata   </td><td class="markdownTableBodyLeft">{robot name}/metadata   </td><td class="markdownTableBodyLeft">See metadata table for a full list of the data points being tracked   </td></tr>
</table>
<p>=================================================================================================== </p>

<p class="definition">Definition at line <a class="el" href="aa_mqtt_8cpp_source.html#l00202">202</a> of file <a class="el" href="aa_mqtt_8cpp_source.html">aaMqtt.cpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>lib/aaMqtt/<a class="el" href="aa_mqtt_8h_source.html">aaMqtt.h</a></li>
<li>lib/aaMqtt/<a class="el" href="aa_mqtt_8cpp_source.html">aaMqtt.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
